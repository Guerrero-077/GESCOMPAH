<form [formGroup]="form" (ngSubmit)="onSubmit()" class="dynamic-form-container">
  <div *ngFor="let field of fields" class="form-field-wrapper">
    <!-- Render the form field only if it's not of type 'hidden' -->
    <ng-container *ngIf="field.type !== 'hidden'">
      <mat-form-field *ngIf="field.type !== 'checkbox'" appearance="outline" class="full-width">
        <mat-label>{{ field.name | titlecase }}</mat-label>
        <ng-container [ngSwitch]="field.type">
          <input matInput *ngSwitchCase="'text'" [formControlName]="field.name"
            [type]="field.name === 'password' ? 'password' : 'text'" />
          <input matInput *ngSwitchCase="'date'" [formControlName]="field.name" type="date" />


          <mat-select *ngSwitchCase="'select'" [formControlName]="field.name" [multiple]="field.multiple"
            [placeholder]="field.name | titlecase" [compareWith]="compareById">
            <mat-option *ngFor="let opt of field.options" [value]="opt.value">{{ opt.label }}</mat-option>
          </mat-select>
          <textarea mat Input *ngSwitchCase="'textarea'" [formControlName]="field.name"></textarea>
        </ng-container>
        <mat-error *ngIf="form.get(field.name)?.invalid && form.get(field.name)?.touched">
          {{ field.name | titlecase }} es requerido.
        </mat-error>
      </mat-form-field>

      <mat-slide-toggle *ngIf="field.type === 'checkbox'" [formControlName]="field.name" color="primary">
        {{ field.name | titlecase }}
      </mat-slide-toggle>
    </ng-container>
  </div>
</form>