<div class="sidebar">
  <div class="header">
    <h3>GESCOMPAH</h3>
    <p>Palermo Locales</p>
  </div>

  <div class="menu">
    <mat-accordion multi="true">
      <ng-container *ngFor="let item of menu(); trackBy: trackByItem">

        <!-- Panel desplegable -->
        <mat-expansion-panel class="sidebar-expansion-panel"
                             *ngIf="(item.children?.length ?? 0) > 1"
                             [expanded]="isGroupActive(item)"
                             [ngClass]="{ 'active': isGroupActive(item) }">

          <mat-expansion-panel-header class="panel-header"
                                      [ngClass]="{ 'active-header': isGroupActive(item) }">
            <mat-panel-title class="panel-title">
              <div class="header-content">
                <div class="icon-box">
                  <mat-icon>{{ item.icon }}</mat-icon>
                </div>
                <div class="label-box">
                  <span class="item-label">{{ item.label }}</span>
                </div>
              </div>
            </mat-panel-title>
          </mat-expansion-panel-header>

          <mat-nav-list class="submenu">
            <a mat-list-item
               *ngFor="let child of item.children; trackBy: trackByChild"
               [routerLink]="child.route"
               routerLinkActive="active"
               [routerLinkActiveOptions]="{ exact: true }"
               (click)="onItemClick()">
              <span class="submenu-label">{{ child.label }}</span>
            </a>
          </mat-nav-list>
        </mat-expansion-panel>

        <!-- Ítem directo -->
        <a mat-list-item
           class="single-link"
           *ngIf="(item.children?.length ?? 0) <= 1 && item.route as r"
           [routerLink]="r"
           routerLinkActive="active"
           [routerLinkActiveOptions]="{ exact: true }"
           [ngClass]="{ 'active-single': isSingleActive(item) }"
           (click)="onItemClick()">
          <span class="link-content">
            <div class="icon-box">
              <mat-icon>{{ item.icon }}</mat-icon>
            </div>
            <div class="label-box">
              <span class="item-label">{{ item.label }}</span>
            </div>
          </span>
        </a>

      </ng-container>
    </mat-accordion>
  </div>

  <div class="logout" (click)="cerrarSesion()">
    <mat-icon>logout</mat-icon> Cerrar Sesión
  </div>
</div>

