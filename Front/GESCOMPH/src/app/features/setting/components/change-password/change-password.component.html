<div class="container">
  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="form-container">
    
    <div class="section-header">
      <h3>Cambiar Contraseña</h3>
    </div>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Contraseña actual</mat-label>
      <input matInput [type]="passwordVisible ? 'text' : 'password'" 
             formControlName="currentPassword" 
             placeholder="••••••••" />
      <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility()">
        <mat-icon>{{ passwordVisible ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <app-form-error [control]="form.get('currentPassword')" label="Contraseña actual"></app-form-error>
      <mat-hint>Ingrese su contraseña actual para verificar su identidad</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Nueva contraseña</mat-label>
      <input matInput [type]="passwordVisible ? 'text' : 'password'" 
             formControlName="newPassword" 
             placeholder="••••••••" />
      <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility()">
        <mat-icon>{{ passwordVisible ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <app-form-error [control]="form.get('newPassword')" label="Nueva contraseña"
        [messages]="newPasswordMessages"></app-form-error>
      <mat-hint>Mínimo 8 caracteres, incluya mayúsculas, minúsculas y números</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Confirmar contraseña</mat-label>
      <input matInput [type]="passwordVisible ? 'text' : 'password'" 
             formControlName="confirmPassword" 
             placeholder="••••••••" />
      <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility()">
        <mat-icon>{{ passwordVisible ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <app-form-error [control]="form.get('confirmPassword')" label="Confirmar contraseña"></app-form-error>
      <mat-error *ngIf="form.hasError('notMatching')">Las contraseñas no coinciden</mat-error>
      <mat-hint>Repita la nueva contraseña para confirmar</mat-hint>
    </mat-form-field>

    <div class="form-actions">
      <app-standard-button 
        text="Cambiar contraseña" 
        variant="raised" 
        color="primary" 
        icon="lock_reset"
        type="submit"
        [disabled]="form.invalid || form.pending"
        (clicked)="onSubmit()">
      </app-standard-button>
    </div>
  </form>
</div>
