<div class="container">
  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="form-container">
    
    <div class="section-header">
      <h3>Cambiar Contraseña</h3>
    </div>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Contraseña actual</mat-label>
      <input matInput [type]="passwordVisible ? 'text' : 'password'" 
             formControlName="currentPassword" 
             placeholder="••••••••" />
      <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility()">
        <mat-icon>{{ passwordVisible ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="form.get('currentPassword')?.hasError('required')">Por favor ingrese la contraseña actual</mat-error>
      <mat-error *ngIf="form.get('currentPassword')?.hasError('incorrect')">La contraseña actual es incorrecta</mat-error>
      <mat-hint>Ingrese su contraseña actual para verificar su identidad</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Nueva contraseña</mat-label>
      <input matInput [type]="passwordVisible ? 'text' : 'password'" 
             formControlName="newPassword" 
             placeholder="••••••••" />
      <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility()">
        <mat-icon>{{ passwordVisible ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="form.get('newPassword')?.hasError('required')">Por favor ingrese la nueva contraseña</mat-error>
      <mat-error *ngIf="form.get('newPassword')?.hasError('minlength')">La contraseña debe tener al menos 8 caracteres</mat-error>
      <mat-error *ngIf="form.get('newPassword')?.hasError('upper')">Debe incluir al menos una letra mayúscula</mat-error>
      <mat-error *ngIf="form.get('newPassword')?.hasError('lower')">Debe incluir al menos una letra minúscula</mat-error>
      <mat-error *ngIf="form.get('newPassword')?.hasError('digit')">Debe incluir al menos un número</mat-error>
      <mat-error *ngIf="form.get('newPassword')?.hasError('symbol')">Debe incluir al menos un símbolo especial</mat-error>
      <mat-hint>Mínimo 8 caracteres, incluya mayúsculas, minúsculas y números</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Confirmar contraseña</mat-label>
      <input matInput [type]="passwordVisible ? 'text' : 'password'" 
             formControlName="confirmPassword" 
             placeholder="••••••••" />
      <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility()">
        <mat-icon>{{ passwordVisible ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="form.get('confirmPassword')?.hasError('required')">Por favor confirme la nueva contraseña</mat-error>
      <mat-error *ngIf="form.hasError('notMatching')">Las contraseñas no coinciden</mat-error>
      <mat-hint>Repita la nueva contraseña para confirmar</mat-hint>
    </mat-form-field>

    <div class="form-actions">
      <app-standard-button 
        text="Cambiar contraseña" 
        variant="raised" 
        color="primary" 
        icon="lock_reset"
        type="submit"
        [disabled]="form.invalid || form.pending"
        (clicked)="onSubmit()">
      </app-standard-button>
    </div>
  </form>
</div>
